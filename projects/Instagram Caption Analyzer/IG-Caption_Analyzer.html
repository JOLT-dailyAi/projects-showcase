<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram Caption Analyzer</title>
    <!-- Fixed CSS path: go up two directories to reach styles.css -->
    <link rel="stylesheet" href="../../styles.css">
</head>
<body>
    <div class="analyzer-container">
        <!-- Back Navigation -->
        <a href="../../index.html" class="back-link">
            ← See Other Projects
        </a>
        
        <!-- Header -->
        <div class="header-section">
            <h1 class="header-title">
                <span class="emoji">📱</span>
                <span class="title-text">Instagram Caption Analyzer</span>
            </h1>
            <p class="header-subtitle">Optimize your captions for maximum engagement</p>
        </div>
        
        <!-- Character Counter Display -->
        <div class="ig-card counter-display">
            <div class="ig-flex ig-justify-between ig-items-center ig-mb-sm">
                <div>
                    <span class="count-number" id="charCount">0</span>
                    <span class="count-limit">/ 2,200 characters</span>
                </div>
                <div class="status-badge status-success" id="status">✅ Perfect Length</div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar" style="width: 0%"></div>
            </div>
        </div>
        
        <!-- Caption Input -->
        <div class="ig-card">
            <textarea 
                id="captionText" 
                class="caption-textarea"
                placeholder="✨ Paste your Instagram caption here and watch the magic happen..."
                oninput="analyzeCaption()"
            ></textarea>
        </div>
        
        <!-- Analysis Results -->
        <div class="ig-card analysis-card" id="analysis">
            <h3 class="analysis-title">📊 Caption Analysis</h3>
            <div id="analysisContent">
                <div class="stat-item">
                    <span class="stat-label">Status:</span>
                    <span class="stat-value">Waiting for input...</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        function analyzeCaption() {
            const text = document.getElementById('captionText').value;
            const charCount = text.length;
            const limit = 2200;
            
            // Update character count
            document.getElementById('charCount').textContent = charCount;
            
            // Calculate progress percentage
            const percentage = Math.min((charCount / limit) * 100, 100);
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = percentage + '%';
            
            // Update status with modern styling - based on current IG best practices
            const statusEl = document.getElementById('status');
            if (charCount === 0) {
                statusEl.textContent = '✨ Ready to Analyze';
                statusEl.className = 'status-badge status-success';
                progressBar.className = 'progress-fill';
            } else if (charCount <= 125) {
                // Instagram mobile shows full caption without "more" button
                statusEl.textContent = '📱 Mobile Perfect';
                statusEl.className = 'status-badge status-success';
                progressBar.className = 'progress-fill';
            } else if (charCount <= 300) {
                // Good engagement range
                statusEl.textContent = '👍 Great Length';
                statusEl.className = 'status-badge status-success';
                progressBar.className = 'progress-fill';
            } else if (charCount <= 1000) {
                // Still good but getting longer
                statusEl.textContent = '📖 Story Mode';
                statusEl.className = 'status-badge status-warning';
                progressBar.className = 'progress-fill warning';
            } else if (charCount <= 2200) {
                // Getting close to limit
                statusEl.textContent = '⚠️ Near Limit';
                statusEl.className = 'status-badge status-warning';
                progressBar.className = 'progress-fill warning';
            } else {
                // Over Instagram's limit
                statusEl.textContent = '❌ Too Long';
                statusEl.className = 'status-badge status-danger';
                progressBar.className = 'progress-fill danger';
            }
            
            // Count hashtags (more accurate regex)
            const hashtags = text.match(/#[a-zA-Z0-9_]+/g) || [];
            const hashtagCount = hashtags.length;
            
            // Count mentions
            const mentions = text.match(/@[a-zA-Z0-9_.]+/g) || [];
            const mentionCount = mentions.length;
            
            // Count emojis (comprehensive emoji detection)
            const emojiCount = (text.match(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]|[\u{1F900}-\u{1F9FF}]|[\u{1FA70}-\u{1FAFF}]/gu) || []).length;
            
            // Count words and lines
            const wordCount = text.trim() ? text.trim().split(/\s+/).length : 0;
            const lineCount = text.split('\n').length;
            
            // Build analysis
            let analysis = `
                <div class="stat-item">
                    <span class="stat-label">📝 Words:</span>
                    <span class="stat-value">${wordCount}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">📄 Lines:</span>
                    <span class="stat-value">${lineCount}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">#️⃣ Hashtags:</span>
                    <span class="stat-value">${hashtagCount}/30 max</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">👤 Mentions:</span>
                    <span class="stat-value">${mentionCount}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">😀 Emojis:</span>
                    <span class="stat-value">${emojiCount}</span>
                </div>
            `;
            
            // Add tips and warnings based on current Instagram best practices
            if (charCount === 0) {
                analysis += `
                    <div class="tip-box tip-info">
                        <strong>💡 Pro Tip:</strong> Start typing to see real-time analysis of your caption!
                    </div>
                `;
            } else {
                if (charCount > 2200) {
                    const overBy = charCount - 2200;
                    analysis += `
                        <div class="tip-box tip-error">
                            <strong>⚠️ Over Limit:</strong> Your caption is ${overBy} characters too long. Instagram will truncate it!
                        </div>
                    `;
                }
                
                // Updated hashtag recommendations based on 2024 best practices
                if (hashtagCount > 30) {
                    analysis += `
                        <div class="tip-box tip-error">
                            <strong>🚫 Too Many Hashtags:</strong> Instagram allows maximum 30 hashtags. You have ${hashtagCount}.
                        </div>
                    `;
                } else if (hashtagCount > 10) {
                    analysis += `
                        <div class="tip-box tip-warning">
                            <strong>📊 Hashtag Tip:</strong> Consider 3-7 targeted hashtags for better engagement than ${hashtagCount}.
                        </div>
                    `;
                } else if (hashtagCount >= 3 && hashtagCount <= 7) {
                    analysis += `
                        <div class="tip-box tip-info">
                            <strong>🎯 Perfect Hashtags:</strong> ${hashtagCount} hashtags is in the sweet spot for 2024!
                        </div>
                    `;
                }
                
                // Mobile optimization tip
                if (charCount <= 125) {
                    analysis += `
                        <div class="tip-box tip-info">
                            <strong>📱 Mobile Perfect:</strong> Your caption displays fully on mobile without "more" button!
                        </div>
                    `;
                }
                
                // Engagement optimization tips
                if (text.includes('?')) {
                    analysis += `
                        <div class="tip-box tip-info">
                            <strong>💬 Great for Engagement:</strong> Questions encourage comments!
                        </div>
                    `;
                }
                
                // Story-style caption detection
                if (charCount > 500 && lineCount > 5) {
                    analysis += `
                        <div class="tip-box tip-info">
                            <strong>📚 Story Mode:</strong> Long-form content can work great for engaged audiences!
                        </div>
                    `;
                }
            }
            
            document.getElementById('analysisContent').innerHTML = analysis;
        }
        
        // Initialize analysis
        analyzeCaption();
        
        // Auto-expand textarea - dynamic sizing
        const textarea = document.getElementById('captionText');
        textarea.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = Math.max(320, this.scrollHeight) + 'px';
        });
        
        // Prevent zoom on iOS when focusing input
        if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
            textarea.addEventListener('focus', function() {
                document.querySelector('meta[name=viewport]').setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no');
            });
            
            textarea.addEventListener('blur', function() {
                document.querySelector('meta[name=viewport]').setAttribute('content', 'width=device-width, initial-scale=1.0');
            });
        }
    </script>
</body>
</html>
